{"version":3,"file":"clickysdk.js","sources":["../src/api/api.js","../src/ui/styles.js","../src/ui/templates.js","../src/core/clicky.js","../src/app.js"],"sourcesContent":["export class ApiClient {\r\n    constructor(serverUrl, token) {\r\n        this.serverUrl = serverUrl;\r\n        this.token = token;\r\n    }\r\n\r\n    async startSession() {\r\n        const res = await fetch(`${this.serverUrl}/api/session/start`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${this.token}`\r\n            },\r\n            body: JSON.stringify({})\r\n        });\r\n\r\n        if (!res.ok) {\r\n            throw new Error(`Session Start Error: ${res.statusText}`);\r\n        }\r\n\r\n        return await res.json();\r\n    }\r\n\r\n    async askPersona(query, persona = null, productId = null) {\r\n        const res = await fetch(`${this.serverUrl}/api/persona/ask`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${this.token}`\r\n            },\r\n            body: JSON.stringify({\r\n                query,\r\n                persona,\r\n                productId\r\n            })\r\n        });\r\n\r\n        if (!res.ok) {\r\n            throw new Error(`Persona Ask Error: ${res.statusText}`);\r\n        }\r\n\r\n        return await res.json();\r\n    }\r\n\r\n    async query(text, context) {\r\n        const res = await fetch(`${this.serverUrl}/api/query`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${this.token}`\r\n            },\r\n            body: JSON.stringify({\r\n                query: text,\r\n                context: context\r\n            })\r\n        });\r\n\r\n        if (!res.ok) {\r\n            throw new Error(`API Error: ${res.statusText}`);\r\n        }\r\n\r\n        return await res.json();\r\n    }\r\n}\r\n\r\n","export const styles = `\r\n  :host { position: fixed; bottom: 20px; right: 20px; z-index: 9999; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }\r\n  :host(.embedded) { position: relative; bottom: auto; right: auto; width: 100%; height: 100%; }\r\n  :host(.embedded) .clicky-ui { width: 100% !important; height: 100% !important; max-height: none; border: none; box-shadow: none; border-radius: 0; }\r\n  \r\n  /* ============================================ */\r\n  /* CONTAINER STYLES */\r\n  /* ============================================ */\r\n  .clicky-ui { background: white; border: 1px solid #e2e8f0; box-shadow: 0 8px 30px rgba(0,0,0,0.12); border-radius: 16px; overflow: hidden; display: flex; flex-direction: column; transition: all 0.3s ease; }\r\n  .clicky-ui.mini { width: 340px; height: 450px; }\r\n  .clicky-ui.full { width: 680px; height: 85vh; }\r\n  .clicky-ui.minimized { height: 48px !important; }\r\n  \r\n  .clicky-header { background: linear-gradient(135deg, #1e1e2e 0%, #2d2d44 100%); color: white; padding: 14px 16px; font-weight: 600; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }\r\n  .clicky-header span:first-child { letter-spacing: -0.5px; }\r\n  #clicky-toggle { opacity: 0.7; transition: opacity 0.2s; }\r\n  #clicky-toggle:hover { opacity: 1; }\r\n  \r\n  .clicky-body { flex: 1; overflow-y: auto; padding: 16px; background: #fafbfc; }\r\n  .clicky-input-area { padding: 12px 16px; border-top: 1px solid #e2e8f0; background: white; display: flex; gap: 10px; }\r\n  .clicky-input { flex: 1; padding: 10px 14px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; transition: border-color 0.2s; }\r\n  .clicky-input:focus { outline: none; border-color: #6366f1; box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }\r\n  .clicky-btn { background: #1e1e2e; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 500; transition: background 0.2s; }\r\n  .clicky-btn:hover { background: #2d2d44; }\r\n  \r\n  /* ============================================ */\r\n  /* GREETING MESSAGE */\r\n  /* ============================================ */\r\n  .clicky-greeting { background: linear-gradient(135deg, #f0f4ff 0%, #e8f4f8 100%); border: 1px solid #d1e5f0; border-radius: 12px; padding: 14px 16px; margin-bottom: 12px; }\r\n  .clicky-greeting p { margin: 0 0 6px 0; font-size: 13px; color: #334155; line-height: 1.5; }\r\n  .clicky-greeting p:last-child { margin-bottom: 0; }\r\n\r\n  /* ============================================ */\r\n  /* PERSONA TOGGLE */\r\n  /* ============================================ */\r\n  .clicky-persona-toggle { display: flex; gap: 8px; padding: 12px 16px; background: #f8fafc; border-bottom: 1px solid #e2e8f0; }\r\n  .clicky-persona-btn { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 10px 8px; border: 2px solid #e2e8f0; border-radius: 10px; background: white; cursor: pointer; transition: all 0.2s; }\r\n  .clicky-persona-btn:hover { border-color: #cbd5e1; }\r\n  .clicky-persona-btn.active { border-color: #6366f1; background: #f0f0ff; }\r\n  .clicky-persona-btn[data-persona=\"REX\"].active { border-color: #f97316; background: #fff7ed; }\r\n  .persona-icon { font-size: 18px; margin-bottom: 4px; }\r\n  .persona-name { font-size: 13px; font-weight: 600; color: #1e1e2e; }\r\n  .persona-role { font-size: 10px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; }\r\n\r\n  /* ============================================ */\r\n  /* PERSONA RESPONSE */\r\n  /* ============================================ */\r\n  .clicky-persona-response { background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 14px 16px; margin-bottom: 12px; }\r\n  .clicky-persona-response.aira { border-left: 4px solid #6366f1; }\r\n  .clicky-persona-response.rex { border-left: 4px solid #f97316; }\r\n  .response-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }\r\n  .response-persona { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; padding: 3px 8px; border-radius: 4px; }\r\n  .clicky-persona-response.aira .response-persona { background: #ede9fe; color: #6366f1; }\r\n  .clicky-persona-response.rex .response-persona { background: #ffedd5; color: #f97316; }\r\n  .response-confidence { width: 60px; height: 6px; background: #e2e8f0; border-radius: 3px; overflow: hidden; }\r\n  .confidence-bar { height: 100%; background: linear-gradient(90deg, #22c55e, #16a34a); border-radius: 3px; transition: width 0.3s; }\r\n  .response-answer { font-size: 14px; color: #334155; line-height: 1.6; margin-bottom: 8px; }\r\n  .response-source { font-size: 11px; color: #94a3b8; }\r\n  .response-notes { font-size: 11px; color: #94a3b8; font-style: italic; margin-top: 8px; }\r\n\r\n  /* ============================================ */\r\n  /* PRODUCT CARD */\r\n  /* ============================================ */\r\n  .clicky-product-card { display: flex; align-items: center; gap: 12px; padding: 14px; background: white; border: 1px solid #e2e8f0; border-radius: 12px; margin-bottom: 10px; transition: box-shadow 0.2s, transform 0.2s; }\r\n  .clicky-product-card:hover { box-shadow: 0 4px 16px rgba(0,0,0,0.08); transform: translateY(-2px); }\r\n  .clicky-card-logo { width: 48px; height: 48px; border-radius: 10px; object-fit: cover; flex-shrink: 0; }\r\n  .clicky-card-content { flex: 1; min-width: 0; }\r\n  .clicky-card-title { font-size: 15px; font-weight: 600; color: #1e1e2e; margin: 0 0 4px 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }\r\n  .clicky-card-tagline { font-size: 13px; color: #64748b; margin: 0; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }\r\n  .clicky-card-meta { display: flex; gap: 8px; margin-top: 6px; font-size: 12px; color: #94a3b8; }\r\n  .clicky-card-action { background: #f1f5f9; color: #475569; padding: 6px 12px; border-radius: 6px; text-decoration: none; font-size: 12px; font-weight: 500; flex-shrink: 0; transition: background 0.2s; }\r\n  .clicky-card-action:hover { background: #e2e8f0; }\r\n  \r\n  .clicky-product-grid { display: flex; flex-direction: column; gap: 10px; }\r\n  \r\n  /* ============================================ */\r\n  /* FOUNDER CARD */\r\n  /* ============================================ */\r\n  .clicky-founder-card { display: flex; gap: 16px; padding: 16px; background: white; border: 1px solid #e2e8f0; border-radius: 12px; }\r\n  .clicky-founder-avatar { width: 64px; height: 64px; border-radius: 50%; object-fit: cover; flex-shrink: 0; }\r\n  .clicky-founder-info { flex: 1; }\r\n  .clicky-founder-name { font-size: 16px; font-weight: 600; color: #1e1e2e; margin: 0 0 4px 0; }\r\n  .clicky-founder-title { font-size: 13px; color: #6366f1; margin: 0 0 2px 0; }\r\n  .clicky-founder-company { font-size: 13px; color: #64748b; margin: 0 0 8px 0; }\r\n  .clicky-founder-bio { font-size: 13px; color: #475569; line-height: 1.5; margin: 0 0 8px 0; }\r\n  .clicky-founder-location { font-size: 12px; color: #94a3b8; margin: 0 0 8px 0; }\r\n  .clicky-founder-socials { display: flex; gap: 8px; font-size: 12px; }\r\n  .clicky-founder-socials a { color: #6366f1; text-decoration: none; }\r\n  .clicky-founder-socials a:hover { text-decoration: underline; }\r\n  \r\n  /* ============================================ */\r\n  /* REVIEW CARD */\r\n  /* ============================================ */\r\n  .clicky-review-card { padding: 14px; background: white; border: 1px solid #e2e8f0; border-radius: 10px; margin-bottom: 10px; }\r\n  .clicky-review-card.positive { border-left: 3px solid #22c55e; }\r\n  .clicky-review-card.negative { border-left: 3px solid #ef4444; }\r\n  .clicky-review-header { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }\r\n  .clicky-review-stars { color: #f59e0b; font-size: 14px; letter-spacing: 1px; }\r\n  .clicky-review-user { font-size: 13px; color: #64748b; }\r\n  .clicky-review-sentiment { font-size: 14px; }\r\n  .clicky-review-title { font-size: 14px; font-weight: 600; color: #1e1e2e; margin: 0 0 6px 0; }\r\n  .clicky-review-text { font-size: 13px; color: #475569; line-height: 1.5; margin: 0; }\r\n  \r\n  .clicky-review-list { display: flex; flex-direction: column; }\r\n  \r\n  /* ============================================ */\r\n  /* COMPARISON TABLE */\r\n  /* ============================================ */\r\n  .clicky-comparison-table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; border: 1px solid #e2e8f0; }\r\n  .clicky-comparison-table th { background: #f8fafc; color: #1e1e2e; font-weight: 600; padding: 12px; text-align: left; font-size: 14px; }\r\n  .clicky-comparison-table td { padding: 12px; border-top: 1px solid #e2e8f0; font-size: 13px; color: #475569; }\r\n  .clicky-comparison-table tr:hover td { background: #f8fafc; }\r\n  .clicky-comparison-table a { color: #6366f1; text-decoration: none; }\r\n  \r\n  /* ============================================ */\r\n  /* STATS WIDGET */\r\n  /* ============================================ */\r\n  .clicky-stats-widget { background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 16px; }\r\n  .clicky-stats-title { font-size: 15px; font-weight: 600; color: #1e1e2e; margin: 0 0 12px 0; }\r\n  .clicky-stats-list { list-style: none; padding: 0; margin: 0; }\r\n  .clicky-stats-item { display: flex; align-items: center; gap: 10px; padding: 10px 0; border-bottom: 1px solid #f1f5f9; }\r\n  .clicky-stats-item:last-child { border-bottom: none; }\r\n  .clicky-stats-rank { width: 24px; height: 24px; background: #f1f5f9; color: #64748b; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; }\r\n  .clicky-stats-name { flex: 1; font-size: 14px; color: #1e1e2e; }\r\n  .clicky-stats-rating { font-size: 12px; color: #f59e0b; }\r\n  \r\n  /* ============================================ */\r\n  /* CATEGORY PILLS */\r\n  /* ============================================ */\r\n  .clicky-category-pills { display: flex; flex-wrap: wrap; gap: 8px; }\r\n  .clicky-category-pill { background: #f1f5f9; color: #475569; padding: 6px 12px; border-radius: 20px; font-size: 13px; cursor: pointer; transition: all 0.2s; }\r\n  .clicky-category-pill:hover { background: #6366f1; color: white; }\r\n  \r\n  /* ============================================ */\r\n  /* PRODUCT DETAIL */\r\n  /* ============================================ */\r\n  .clicky-product-detail { background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 20px; }\r\n  .clicky-detail-header { display: flex; gap: 16px; margin-bottom: 16px; }\r\n  .clicky-detail-logo { width: 80px; height: 80px; border-radius: 14px; object-fit: cover; }\r\n  .clicky-detail-name { font-size: 20px; font-weight: 700; color: #1e1e2e; margin: 0 0 4px 0; }\r\n  .clicky-detail-tagline { font-size: 14px; color: #64748b; margin: 0 0 8px 0; }\r\n  .clicky-detail-description { font-size: 14px; color: #475569; line-height: 1.6; margin: 0 0 16px 0; }\r\n  .clicky-detail-meta { display: flex; flex-wrap: wrap; gap: 12px; font-size: 13px; color: #64748b; margin-bottom: 16px; }\r\n  .clicky-tags { display: flex; gap: 6px; flex-wrap: wrap; }\r\n  .clicky-tag { background: #f1f5f9; color: #64748b; padding: 3px 8px; border-radius: 4px; font-size: 11px; }\r\n  .clicky-team { margin-bottom: 16px; }\r\n  .clicky-team h5 { font-size: 13px; color: #64748b; margin: 0 0 8px 0; }\r\n  .clicky-team-member { font-size: 13px; color: #475569; }\r\n  .clicky-detail-cta { display: inline-block; background: #6366f1; color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-size: 14px; font-weight: 500; transition: background 0.2s; }\r\n  .clicky-detail-cta:hover { background: #4f46e5; }\r\n  \r\n  /* ============================================ */\r\n  /* UTILITY STYLES */\r\n  /* ============================================ */\r\n  .clicky-rating { color: #f59e0b; font-weight: 500; }\r\n  .clicky-categories { color: #94a3b8; }\r\n  .clicky-empty { color: #94a3b8; font-style: italic; text-align: center; padding: 20px; }\r\n  .clicky-error { color: #ef4444; background: #fef2f2; padding: 12px; border-radius: 8px; border: 1px solid #fecaca; }\r\n  .clicky-section { margin-bottom: 16px; }\r\n  .clicky-title { font-size: 15px; font-weight: 600; margin-bottom: 10px; color: #1e1e2e; }\r\n  .clicky-list { padding-left: 20px; color: #475569; }\r\n  .clicky-badge { display: inline-block; background: #f1f5f9; padding: 3px 8px; border-radius: 4px; font-size: 12px; margin: 2px; color: #64748b; }\r\n  \r\n  /* ============================================ */\r\n  /* PLATFORM STATS */\r\n  /* ============================================ */\r\n  .clicky-platform-stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }\r\n  .clicky-stat-card { background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 16px; text-align: center; }\r\n  .clicky-stat-value { display: block; font-size: 28px; font-weight: 700; color: #6366f1; }\r\n  .clicky-stat-label { display: block; font-size: 12px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 4px; }\r\n  \r\n  /* ============================================ */\r\n  /* FOUNDER GRID */\r\n  /* ============================================ */\r\n  .clicky-founder-grid { display: flex; flex-direction: column; gap: 12px; }\r\n`;\r\n","export const renderMainUI = (mode) => {\r\n  const title = mode === 'full' ? 'REX (Actions)' : 'AIRA (Records)';\r\n  const placeholder = mode === 'full' ? 'Ask REX to perform actions...' : 'Ask AIRA about records...';\r\n\r\n  return `\r\n  <div class=\"clicky-header\">\r\n    <span>${title}</span>\r\n    <span id=\"clicky-toggle\">_</span>\r\n  </div>\r\n  <div class=\"clicky-body\" id=\"clicky-results\">\r\n    <div id=\"clicky-suggestions\"></div>\r\n  </div>\r\n  <div class=\"clicky-input-area\">\r\n    <input type=\"text\" class=\"clicky-input\" id=\"clicky-input\" placeholder=\"${placeholder}\" />\r\n    <button class=\"clicky-btn\" id=\"clicky-send\">Ask</button>\r\n  </div>\r\n`;\r\n};\r\n\r\nexport const renderPersonaResponse = (response) => {\r\n  const personaClass = response.persona === 'AIRA' ? 'aira' : 'rex';\r\n  const confidenceBar = Math.round(response.confidence * 100);\r\n\r\n  return `\r\n    <div class=\"clicky-persona-response ${personaClass}\">\r\n        <div class=\"response-header\">\r\n            <span class=\"response-persona\">${response.persona || 'SYSTEM'}</span>\r\n            <span class=\"response-confidence\" title=\"Confidence: ${confidenceBar}%\">\r\n                <span class=\"confidence-bar\" style=\"width: ${confidenceBar}%\"></span>\r\n            </span>\r\n        </div>\r\n        <div class=\"response-answer\">${response.answer}</div>\r\n        ${response.source && response.source.length > 0 ? `\r\n            <div class=\"response-source\">\r\n                Source: ${response.source.join(', ')}\r\n            </div>\r\n        ` : ''}\r\n        ${response.notes ? `<div class=\"response-notes\">${response.notes}</div>` : ''}\r\n    </div>\r\n    `;\r\n};\r\n\r\nexport const renderLoading = (id) => `<p id=\"${id}\" style=\"color:#666; font-style:italic;\">Thinking...</p>`;\r\n\r\nexport const renderError = (msg) => {\r\n  const p = document.createElement('p');\r\n  p.className = 'clicky-error';\r\n  p.textContent = msg;\r\n  return p;\r\n};\r\n\r\nexport const renderSummary = (text) => {\r\n  const div = document.createElement('div');\r\n  Object.assign(div.style, {\r\n    marginTop: '10px',\r\n    padding: '8px',\r\n    background: '#eef',\r\n    borderRadius: '4px'\r\n  });\r\n  div.textContent = text;\r\n  return div;\r\n};\r\n\r\nexport const renderSuggestions = (suggestions, onClick) => {\r\n  const container = document.createElement('div');\r\n  container.style.marginTop = '10px';\r\n  suggestions.forEach(s => {\r\n    const btn = document.createElement('button');\r\n    btn.textContent = s;\r\n    Object.assign(btn.style, {\r\n      margin: '2px',\r\n      fontSize: '0.8em',\r\n      background: 'none',\r\n      border: '1px solid #ccc',\r\n      borderRadius: '4px',\r\n      cursor: 'pointer',\r\n      padding: '2px 6px'\r\n    });\r\n    btn.onclick = () => onClick(s);\r\n    container.appendChild(btn);\r\n  });\r\n  return container;\r\n};\r\n","import { ApiClient } from '../api/api.js';\r\nimport { styles } from '../ui/styles.js';\r\nimport { renderMainUI, renderLoading, renderError, renderPersonaResponse } from '../ui/templates.js';\r\n\r\nexport class ClickyCore {\r\n    constructor(config) {\r\n        this.config = null;\r\n        this.api = null;\r\n        this.shadowRoot = null;\r\n        this.host = null;\r\n        // Determine default persona based on mode (if provided in config later)\r\n        this.selectedPersona = 'AIRA'; // Default\r\n\r\n\r\n        if (config) {\r\n            this.init(config);\r\n        }\r\n    }\r\n\r\n    init(config) {\r\n        if (this.config) {\r\n            console.warn('Clicky already initialized');\r\n            return;\r\n        }\r\n\r\n        if (!config || !config.token) {\r\n            console.error('Clicky: Auth token is required.');\r\n            return;\r\n        }\r\n\r\n        this.config = {\r\n            mode: 'mini',\r\n            serverUrl: 'http://localhost:5003',\r\n            ...config\r\n        };\r\n\r\n        this.api = new ApiClient(this.config.serverUrl, this.config.token);\r\n\r\n        // Dynamic Persona Selection\r\n        if (this.config.mode === 'full') {\r\n            this.selectedPersona = 'REX';\r\n        } else {\r\n            this.selectedPersona = 'AIRA';\r\n        }\r\n\r\n        console.log('[Foundry AI] Core Initialized. Persona:', this.selectedPersona);\r\n        // this.mount(); //no need\r\n    }\r\n\r\n    mount() {\r\n        // Find Container\r\n        let container = null;\r\n        const target = this.config.containerId; // Support string or element\r\n\r\n        if (target) {\r\n            if (typeof target === 'string') {\r\n                container = document.getElementById(target);\r\n            } else if (target instanceof HTMLElement) {\r\n                container = target;\r\n            }\r\n        }\r\n\r\n        if (!container) {\r\n            return false;\r\n        }\r\n\r\n        // Reuse existing Host if available (Preserves Chart/State)\r\n        if (this.host) {\r\n            this.host.classList.add('embedded');\r\n            container.appendChild(this.host);\r\n            return true;\r\n        }\r\n\r\n        // Require creation\r\n        const host = document.createElement('div');\r\n        host.id = 'clicky-host';\r\n        host.classList.add('embedded');\r\n        container.appendChild(host);\r\n\r\n        this.host = host; // Store ref\r\n        this.shadowRoot = host.attachShadow({ mode: 'open' });\r\n\r\n        // Styles\r\n        const styleTag = document.createElement('style');\r\n        styleTag.textContent = styles;\r\n        this.shadowRoot.appendChild(styleTag);\r\n\r\n        // UI Wrapper\r\n        const wrapper = document.createElement('div');\r\n        wrapper.className = `clicky-ui ${this.config.mode}`;\r\n        wrapper.innerHTML = renderMainUI(this.config.mode);\r\n        this.shadowRoot.appendChild(wrapper);\r\n\r\n        // Event Bindings\r\n        this.bindEvents(wrapper);\r\n\r\n        // Display initial greeting\r\n        // this.showGreeting();\r\n\r\n        return true;\r\n    }\r\n\r\n    bindEvents(wrapper) {\r\n        const input = this.shadowRoot.getElementById('clicky-input');\r\n        const sendBtn = this.shadowRoot.getElementById('clicky-send');\r\n        const toggleBtn = this.shadowRoot.getElementById('clicky-toggle');\r\n\r\n        // Send query\r\n        sendBtn.addEventListener('click', () => this.handlePersonaQuery(input.value));\r\n        input.addEventListener('keypress', (e) => {\r\n            if (e.key === 'Enter') this.handlePersonaQuery(input.value);\r\n        });\r\n\r\n        // Toggle minimize\r\n        toggleBtn.addEventListener('click', () => {\r\n            wrapper.classList.toggle('mini');\r\n            wrapper.classList.toggle('minimized');\r\n            if (wrapper.classList.contains('minimized')) {\r\n                wrapper.style.height = '48px';\r\n            } else {\r\n                wrapper.style.height = '';\r\n            }\r\n        });\r\n    }\r\n\r\n    async handlePersonaQuery(queryText) {\r\n        const input = this.shadowRoot.getElementById('clicky-input');\r\n        const results = this.shadowRoot.getElementById('clicky-results');\r\n        const query = queryText.trim();\r\n\r\n        if (!query) return;\r\n\r\n        // UI Optimistic Update\r\n        const loadingId = 'loading-' + Date.now();\r\n        results.insertAdjacentHTML('beforeend', renderLoading(loadingId));\r\n        results.scrollTop = results.scrollHeight;\r\n        input.value = '';\r\n\r\n        try {\r\n            // Use persona API\r\n            const response = await this.api.askPersona(\r\n                query,\r\n                this.selectedPersona,\r\n                this.config.productId // Optional product context\r\n            );\r\n\r\n            console.log('[Foundry AI] API Response:', response);\r\n\r\n            // Normalize response (handle {data: ...} wrapper if present)\r\n            const data = response.data || response;\r\n\r\n            // Remove loader\r\n            const loader = this.shadowRoot.getElementById(loadingId);\r\n            if (loader) loader.remove();\r\n\r\n            // Render persona response\r\n            if (data && data.answer) {\r\n                const html = renderPersonaResponse(data);\r\n                results.insertAdjacentHTML('beforeend', html);\r\n            } else {\r\n                console.error('[Foundry AI] Invalid response format:', data);\r\n                results.appendChild(renderError('Received invalid response from AI.'));\r\n            }\r\n\r\n        } catch (err) {\r\n            console.error('[Foundry AI] Error:', err);\r\n            const loader = this.shadowRoot.getElementById(loadingId);\r\n            if (loader) loader.remove();\r\n            results.appendChild(renderError('Connection failed.'));\r\n        }\r\n\r\n        results.scrollTop = results.scrollHeight;\r\n    }\r\n    toggle() {\r\n        const wrapper = this.shadowRoot ? this.shadowRoot.querySelector('.clicky-ui') : null;\r\n        if (wrapper) {\r\n            // Check if minimized\r\n            const isMinimized = wrapper.classList.contains('minimized');\r\n            if (isMinimized) {\r\n                // Open\r\n                wrapper.classList.remove('minimized', 'mini');\r\n                wrapper.style.height = '';\r\n            } else {\r\n                // Close/Minimize\r\n                wrapper.classList.add('minimized', 'mini');\r\n                wrapper.style.height = '48px';\r\n            }\r\n        }\r\n    }\r\n\r\n    open() {\r\n        const wrapper = this.shadowRoot ? this.shadowRoot.querySelector('.clicky-ui') : null;\r\n        if (wrapper) {\r\n            wrapper.classList.remove('minimized', 'mini');\r\n            wrapper.style.height = '';\r\n        }\r\n    }\r\n}\r\n","import { ClickyCore } from './core/clicky.js';\r\n\r\n// Global Class Export\r\n// Global Class Export\r\nexport const ClickyBot = ClickyCore;\r\nwindow.ClickyBot = ClickyCore; \r\n"],"names":["ApiClient","serverUrl","token","res","query","persona","productId","text","context","styles","renderMainUI","mode","renderPersonaResponse","response","personaClass","confidenceBar","renderLoading","id","renderError","msg","p","ClickyCore","config","container","target","host","styleTag","wrapper","input","sendBtn","toggleBtn","e","queryText","results","loadingId","data","loader","html","err","ClickyBot"],"mappings":"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"}